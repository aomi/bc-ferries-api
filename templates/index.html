<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
      BC Ferries API
    </title>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400&display=swap" rel="stylesheet"> 
    <link rel="shortcut icon" href="/static/favicon.ico">
    <link rel="stylesheet" href="../static/styles/main.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  </head>
  <body>
    <div class="main">
      <h1 class="title">BC Ferries API</h1>
      <p>*In progress site*</p>
      <hr>
      <div>
        <div class="api-input">
          <span>https://www.bcferriesapi.ca/api/</span>
          <input id="interactive" type="text" placeholder="tsawwassen/swartz-bay">
          <span>
            <button onClick="interactive_call(); return false;">request</button>
          </span>
        </div>
        <div class="hint">
          <small>Need a hint? try 
            <a class="hint-link" href="#" onClick="update('tsawwassen/'); return false;">
              <i>tsawwassen/</i>
            </a> 
            or 
            <a class="hint-link" href="#" onClick="update('nanaimo-(dep.bay)/horseshoe-bay/'); return false;">
              <i>nanaimo-(dep.bay)/horseshoe-bay/</i>
            </a>
          </small>
        </div>
        <h3 class="header">Result:</h3>
        <div>
          <pre id="interactive_output">Send a request to see the response here!</pre>
        </div>
      </div>
      <hr>
      <div>
        <div class="section">
          <h3 class="header">About</h3>
          <p class="text">
            This API is the only free and open source API for retrieving BC Ferries route info, times, and waits. Consult the 
            <a href="https://github.com/samuel-pratt/ferry-times-api/blob/master/README.md">ReadMe</a> 
            if you'd like to get started. If something isn't working, submit an issue 
            <a href="https://github.com/samuel-pratt/ferry-times-api/issues/new">on GitHub</a>
          </p>
        </div>
      </div>
      <hr>
      <div>
        &copy; 2021 by Sam Pratt
      </div>
      <script>
        function update(call) {
          jQuery('#interactive').val(call);
          interactive_call();
        }

        function interactive_call() {
          var content = jQuery('#interactive').val()
          var call_url = 'api/' + content;
          jQuery.ajax({
            dataType: 'json',
            url: call_url,
            context: document.body,
            success: function (data) {
              if (data['status'] == 200) {
                var d = jQuery.parseJSON(data['responseText']);
                jQuery('#interactive_output').text(JSON.stringify(d, null, '\t'));
              } else if (data['status'] == 404) {
                jQuery('#interactive_output').text(data['status'] + ' ' + data['statusText']);
              }
            }
          })
        }
      </script>
    </div>
  </body>
</html>
